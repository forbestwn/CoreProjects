<!DOCTYPE html>
<html>
<head>
        <meta charset="utf-8" />
        <title>Nosliw Go Go !!</title>

    	<link rel="stylesheet" href="libresources/external/framework7/css/framework7.bundle.min.css">
        <script src="libresources/external/framework7/4.3.1/framework7.bundle.js"></script>
        <script src="libresources/external/jQuery/2.1.0/jquery.js"></script>
        
        <script src="libresources/external/log4javascript/1.0.0/log4javascript.js"></script>
		<script src="libresources/nosliw/runtimebrowserinit/init.js"></script>

 		<meta name="viewport" content="width=device-width, initial-scale=1"> 

</head>

<body>
		<div class="panel panel-left panel-cover">
      		<div class="view panel-view block" id="debugDiv">
				<div id="lifecycleDebug"></div>
				<div id="inputDebug"></div>
         	</div>
    	</div>

		<div id="moduleDiv"></div>
	
		<div class="panel panel-right panel-cover">
      		<div class="block" id="debugDiv">
				<div id="dataDebug"></div>
				<div id="eventDebug"></div>
         	</div>
    	</div>
	
</body>

<script>


$(document).on("nosliwActive", function(){

	var node_createServiceRequestInfoSequence = nosliw.getNodeData("request.request.createServiceRequestInfoSequence");
	var node_requestServiceProcessor = nosliw.getNodeData("request.requestServiceProcessor");
	var node_COMMONCONSTANT = nosliw.getNodeData("constant.COMMONCONSTANT");
	var node_COMMONATRIBUTECONSTANT = nosliw.getNodeData("constant.COMMONATRIBUTECONSTANT");
	var node_getComponentLifecycleInterface = nosliw.getNodeData("component.getComponentLifecycleInterface");
	var node_createComponentLifeCycleDebugView = nosliw.getNodeData("component.createComponentLifeCycleDebugView");
	var node_createComponentDataView = nosliw.getNodeData("component.createComponentDataView");
	var node_createComponentEventView = nosliw.getNodeData("component.createComponentEventView");
	var node_createComponentResetView = nosliw.getNodeData("component.createComponentResetView");

	var loc_moduleId;
	var loc_uiModuleRuntime;
	
	var loc_configure = function(){
		// Our initialization code here
		var currentSearchString = window.location.search;
		var parmValue = currentSearchString.substring(currentSearchString.indexOf("=")+1);
		var index = parmValue.indexOf(";");
		loc_moduleId = parmValue.substring(0, index);
		
		var moduleparms = parmValue.substring(index+1);
		index = moduleparms.indexOf(";");
		var moduleDecId = moduleparms.substring(0, index);
		var decoration = moduleparms.substring(index+1);
		
		//create module runtime
		var decorations = {};
		decorations[node_COMMONATRIBUTECONSTANT.DEFINITIONDECORATION_GLOBAL] = [decoration];
		var configure = {
			global : {
				root : $('#moduleDiv').get(),
				decoration : decorations,
				moduleDecoration : ["base", "uidecoration", moduleDecId, "debug"],
				__storeService :{
					saveData : function(categary, id, data){
						localStorage.setItem(categary+"_"+id, JSON.stringify(data));
					},
					
					retrieveData : function(categary, id){
						return JSON.parse(localStorage.getItem(categary+"_"+id));
					},
					
					clearData : function(categary, id){
						return localStorage.removeItem(categary+"_"+id);
					}
				}
			},
			components : {
				application_framework7_mobile : {
					app : new Framework7({
						  // App root element
						  root: $("#moduleDiv").get(),
						  name: 'My App',
						  id: 'com.myapp.test',
						  panel: {
							    swipe: 'both',
						  },		
					}),
				}
			}
		};
		return configure;
	}();
	
	
	var loc_debugLifecycleView = node_createComponentLifeCycleDebugView();
	$('#lifecycleDebug').append(loc_debugLifecycleView.getView());
	
	var loc_debugDataView = node_createComponentDataView();
	$('#dataDebug').append(loc_debugDataView.getView());

	var loc_debugEventView = node_createComponentEventView();
	$('#eventDebug').append(loc_debugEventView.getView());

	
	var loc_debugResetView = node_createComponentResetView(function(){
		if(loc_uiModuleRuntime!=undefined){
			loc_lifecycle = node_getComponentLifecycleInterface(loc_uiModuleRuntime);
			loc_lifecycle.transit(node_CONSTANT.LIFECYCLE_COMPONENT_STATUS_DEAD);
			loc_uiModuleRuntime = undefined;
		}
		nosliw.runtime.getUIModuleService().executeGetUIModuleRuntimeRequest(loc_moduleId, loc_moduleId, loc_configure, loc_debugResetView.getInputIODataSet(), {
			success : function(requestInfo, uiModuleRuntime){
				loc_uiModuleRuntime = uiModuleRuntime;
				loc_debugLifecycleView.setComponent(uiModuleRuntime, requestInfo);
				loc_debugDataView.setComponent(uiModuleRuntime, requestInfo);
				loc_debugEventView.setComponent(uiModuleRuntime, requestInfo);
			}
		});
	});
	$('#inputDebug').append(loc_debugResetView.getView());
});


nosliw.init();
</script>

</html>
